<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset='utf-8' />
    <title>FullCalendar with Cookie Support, Leave Confirmation, and Notifications</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/main.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="calendar.css">
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <style>
      body {
        margin: 40px 10px;
        padding: 0;
        font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
        font-size: 14px;
      }
      #calendar {
        max-width: 1100px;
        margin: 0 auto;
      }
      .fc-daygrid-event-title {
        white-space: normal;
      }
    </style>
</head>
<body>
<button id="deleteEvent" style="margin-bottom: 10px;">Delete Selected Event</button>
<div id='calendar'></div>
<button id="saveEventsBtn" style="margin-top: 10px;">Save Events</button>
<button id="loadEventsBtn" style="margin-top: 10px;">Load Events</button>
<button onclick="requestAndTestNotification()">Test Notification</button>

<script defer src="site-logic-1.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const className = urlParams.get('className');
    const creditHours = urlParams.get('creditHours');
    
    // Initialize the calendar
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
      // Add your calendar options here
      initialView: 'dayGridMonth'
    });
    calendar.render();
    
    // Function to add event to the calendar
    function addEventToCalendar(className, creditHours) {
      calendar.addEvent({
        title: `${className} (${creditHours} hours)`,
        start: new Date(), // Placeholder for the start date
        end: new Date(), // Placeholder for the end date, adjust as needed
      });
    }

    // Check if we have class details in URL parameters and add it to the calendar
    if (className && creditHours) {
      addEventToCalendar(className, creditHours);
    }
  });

  // Listen for postMessage
  window.addEventListener('message', (event) => {
    // Replace "http://yourorigin.com" with the origin you expect the message from
    if (event.origin === "http://yourorigin.com") {
      const { type, data } = event.data;
      if (type === "addClass") {
        addEventToCalendar(data.className, data.creditHours);
      }
    } else {
      console.error('Received message from unauthorized origin:', event.origin);
    }
  });
</script>
</body>
</html>
